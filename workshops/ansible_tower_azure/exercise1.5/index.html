<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Exercise 1.5 - Roles: Making your playbooks reusable | Red Hat | Public Sector</title>

    
    
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly.min.css" />
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly-additions.min.css" />

    
    <link rel="stylesheet" href="/node_modules/highlight.js/styles/darkula.css" />

    
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/asciidoc.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <link rel="stylesheet" href="/css/toastr.min.css" />

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DL741MBBZQ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DL741MBBZQ');
    </script>

    
    <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery/dist/jquery.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/c3/c3.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/d3/d3.min.js"></script>

    
    
    <script src="/node_modules/patternfly/node_modules/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/drmonty-datatables-colvis/js/dataTables.colVis.js"></script>
    <script src="/node_modules/patternfly/node_modules/datatables.net-colreorder/js/dataTables.colReorder.js"></script>

    
    
    <script src="/node_modules/patternfly/dist/js/patternfly.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-combobox/js/bootstrap-combobox.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/moment/min/moment.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-select/dist/js/bootstrap-select.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-switch/dist/js/bootstrap-switch.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-treeview/dist/bootstrap-treeview.min.js"></script>

    
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery-match-height/dist/jquery.matchHeight-min.js"></script>
    
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/clip.js"></script>

    
    <script src="/js/toastr.min.js"></script>

    
    <script src="/node_modules/highlight.js/lib/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body class="">
    

<nav class="navbar navbar-default navbar-inverse navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
      <svg width=150 height=auto id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145"><defs><style>.cls-1{fill:#e00;}.cls-2{fill:#fff;}</style></defs><path class="cls-1" d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/><path d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/><path class="cls-2" d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/></svg>
      </a>
    </div>
    <div class="collapse navbar-collapse navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        
        
          
            <li>
              <a href="/">Home</a>
            </li>
          
        
          
            <li>
              <a href="/about/">About</a>
            </li>
          
        
          
            <li>
              <a href="/contact/">Contact</a>
            </li>
          
        
          
            <li>
              <a href="https://www.redhat.com/en/events">Events</a>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Workshops <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/agile_integrations_ci/">Agile Integrations Workshop - Citizen Integrator</a>
                  </li>
                
                  <li>
                    <a href="/workshops/agile_integrations_dev/">Agile Integrations Workshop - Developer</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_automation/">Ansible Automation Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_tower_intro/">Ansible Tower - an Introduction</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_container_intro/">Container Security - A Practical Introduction</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_101/">Containers 101 Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/secure_software_factory/">DevSecOps Workshop - Secure Software Factory</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_the_hard_way/">Linux Containers the Hard Way</a>
                  </li>
                
                  <li>
                    <a href="/workshops/strangling_the_monolith/">Microservices Workshop - Strangling the Monolith</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_4_101/">OpenShift 4 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_4_101_dynatrace/">OpenShift 4 101 w/Dynatrace</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_serverless/">OpenShift Serverless</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_service_mesh/">OpenShift Service Mesh</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhel_8/">Red Hat Enterprise Linux 8</a>
                  </li>
                
                  <li>
                    <a href="/workshops/selinux_policy/">SELinux Policy Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_service_mesh_v1.0/">zOpenShift Service Mesh</a>
                  </li>
                
              </ul>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                alpha <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/alpha/ansible_with_rhocp_edge/">Applied Ansible Automation - Containerized Edge Workshop</a>
                  </li>
                
              </ul>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Retired <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/ansible_tower_azure/">Ansible Tower Workshop on Azure</a>
                  </li>
                
                  <li>
                    <a href="/workshops/cloudforms41/">CloudForms Workshops</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_containers/">Container Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/jdv_dev/">JBoss Data Virtualization Development</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_101_dcmetromap/">OpenShift 101 - DC Metro Map Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_openshift/">OpenShift Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhosp_101/">Red Hat OpenStack Platform 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/source_to_image/">Source to Image</a>
                  </li>
                
              </ul>
            </li>
          
        
      </ul>
    </div>
  </div>
</nav>



<div class="jumbotron jumbotron-page text-center">
  <h1>Exercise 1.5 - Roles: Making your playbooks reusable</h1>
</div>

<div class="container">
  <div class="row">
    <p class="text-center">
      
      <a href="/workshops/ansible_tower_azure">Return to Workshop</a>
    </p>

    








<nav>
  <ul class="pager">
    
    
    <li class="previous">
      <a href="/workshops/ansible_tower_azure/exercise1.4/">&larr; Previous: Exercise 1.4 - Running the apache-basic-playbook</a>
    </li>
    
    
    
    
    <li class="next">
      <a href="/workshops/ansible_tower_azure/exercise2.0/">Next: Exercise 2.0 - Installing Ansible Tower &rarr;</a>
    </li>
    
    
  </ul>
</nav>

    <div class="sect1">
<h2 id="_exercise_description">Exercise Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While it is possible to write a playbook in one file as we’ve done throughout this workshop, eventually you’ll want to reuse files and start to organize things.</p>
</div>
<div class="paragraph">
<p>The &#34;role&#34; feature in Ansible is the way we do this. When you create a role, you deconstruct your playbook into parts and those parts sit in a directory structure.  <em>&#34;Wha??  You mean that seemingly useless <a href="http://docs.ansible.com/ansible/playbooks_best_practices.html">best practice</a> you mentioned in exercise 1.2?&#34;.</em>  Yep, that one.</p>
</div>
<div class="paragraph">
<p>For this exercise, you are going to take the playbook you just wrote and refactor it into a role.  In addition, you’ll learn to use Ansible Galaxy.</p>
</div>
<div class="paragraph">
<p>Let’s begin with seeing how your apache-basic-playbook will break down into a role.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/workshops/ansible_tower_azure/images/roledir_1.png" alt="apache-basic-playbook role directory structure"/>
</div>
</div>
<div class="paragraph">
<p>Fortunately, you don’t have to create all of these directories and files by hand.  That’s where Ansible Galaxy comes in.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_1_using_ansible_galaxy_to_initialize_a_new_role">Section 1: Using Ansible Galaxy to initialize a new role</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ansible Galaxy is a free site for finding, downloading, and sharing roles.  It’s also pretty handy for creating them which is what we are about to do here.</p>
</div>
<div class="sect2">
<h3 id="_step_1_navigate_to_your_project">Step 1: Navigate to your project</h3>
<div class="paragraph">
<p>Navigate to your <code>apache-basic-playbook</code> project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cd ~/apache-basic-playbook</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_create_a_directory">Step 2: Create a directory</h3>
<div class="paragraph">
<p>Create a directory called <code>roles</code> and <code>cd</code> into it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">mkdir roles
cd roles</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_initialize_new_role">Step 3: Initialize new role</h3>
<div class="paragraph">
<p>Use the <code>ansible-galaxy</code> command to initialize a new role called <code>apache-simple</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">ansible-galaxy init apache-simple</code></pre>
</div>
</div>
<div class="paragraph">
<p>Take a look around the structure you just created.  It should look a lot like Figure 1 above.  However, we need to complete one more step before moving onto section 2.  It is Ansible best practice to clean out role directories and files you won’t be using.  For this role, we won’t be using anything from <code>files</code>, <code>tests</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_remove_directories">Step 4: Remove directories</h3>
<div class="paragraph">
<p>Remove the <code>files</code> and <code>tests</code> directories</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cd ~/apache-basic-playbook/roles/apache-simple/
rm -rf files tests</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_2_breaking_your_site_yml_playbook_into_the_newly_created_apache_simple_role">Section 2: Breaking Your <code>site.yml</code> Playbook into the Newly Created <code>apache-simple</code> Role</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we will separate out the major parts of your playbook including <code>vars:</code>, <code>tasks:</code>, <code>template:</code>, and <code>handlers:</code>.</p>
</div>
<div class="sect2">
<h3 id="_step_1_backup">Step 1: Backup</h3>
<div class="paragraph">
<p>Make a backup copy of <code>site.yml</code>, then create a new <code>site.yml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cd ~/apache-basic-playbook
mv site.yml site.yml.bkup
vim site.yml</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_add_play_definitioninvoke_role">Step 2: Add play definition/Invoke role</h3>
<div class="paragraph">
<p>Add the play definition and the invocation of a single role.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">---
- hosts: web
  name: This is my role-based playbook
  become: yes

  roles:
    - apache-simple</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_add_default_variables">Step 3: Add default variables</h3>
<div class="paragraph">
<p>Add some default variables to your role in <code>roles/apache-simple/defaults/main.yml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">---
# defaults file for apache-simple
apache_test_message: This is a test message
apache_max_keep_alive_requests: 115</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_add_variables">Step 4: Add variables</h3>
<div class="paragraph">
<p>Add some role-specific variables to your role in <code>roles/apache-simple/vars/main.yml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">---
# vars file for apache-simple
httpd_packages:
  - httpd
  - mod_wsgi</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Hey, wait a minute…​did you just have us put variables in two separate places?<br/></p>
</div>
<div class="paragraph">
<p>Yes…​yes we did.  Variables can live in quite a few places.  Just to name a few:<br/></p>
</div>
<div class="ulist">
<ul>
<li>
<p>vars directory</p>
</li>
<li>
<p>defaults directory</p>
</li>
<li>
<p>group_vars directory</p>
</li>
<li>
<p>In the playbook under the <code>vars:</code> section</p>
</li>
<li>
<p>In any file which can be specified on the command line using the <code>--extra_vars</code> option</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Bottom line, you need to read up on <a href="http://docs.ansible.com/ansible/latest/playbooks_variables.html#variable-precedence-where-should-i-put-a-variable">variable precedence</a> to understand both where to define variables and which locations take precedence.  In this exercise, we are using role defaults to define a couple of variables and these are the most malleable.  After that, we defined some variables in <code>/vars</code>
which have a higher precedence than defaults and can’t be overridden as a default variable.</p>
</div>
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_create_role_handler">Step 5: Create role handler</h3>
<div class="paragraph">
<p>Create your role handler in <code>roles/apache-simple/handlers/main.yml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">---
# handlers file for apache-simple
- name: restart apache service
  service:
    name: httpd
    state: restarted
    enabled: yes</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_add_role_tasks">Step 6: Add role tasks</h3>
<div class="paragraph">
<p>Add tasks to your role in <code>roles/apache-simple/tasks/main.yml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">---
# tasks file for apache-simple
- name: install httpd packages
  package:
    name: &#34;{{ item }}&#34;
    state: present
  with_items: &#34;{{ httpd_packages }}&#34;
  notify: restart apache service

- name: create site-enabled directory
  file:
    name: /etc/httpd/conf/sites-enabled
    state: directory

- name: copy httpd.conf
  template:
    src: templates/httpd.conf.j2
    dest: /etc/httpd/conf/httpd.conf
  notify: restart apache service

- name: copy index.html
  template:
    src: templates/index.html.j2
    dest: /var/www/html/index.html

- name: start httpd
  service:
    name: httpd
    state: started
    enabled: yes</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_7_download_templates">Step 7: Download templates</h3>
<div class="paragraph">
<p>Download a couple of templates into <code>roles/apache-simple/templates/</code>.  And right after that, let’s clean up from exercise 2.1 by removing the old templates directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">mkdir -p ~/apache-basic-playbook/roles/apache-simple/templates/
cd ~/apache-basic-playbook/roles/apache-simple/templates/
curl -O http://ansible-workshop.redhatgov.io/workshop-files/httpd.conf.j2
curl -O http://ansible-workshop.redhatgov.io/workshop-files/index.html.j2
rm -rf ~/apache-basic-playbook/templates/</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_3_running_your_new_role_based_playbook">Section 3: Running your new role-based playbook</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that you’ve successfully separated your original playbook into a role,
let’s run it and see how it works.</p>
</div>
<div class="sect2">
<h3 id="_step_1_run_the_playbook">Step 1: Run the playbook</h3>
<div class="paragraph">
<p>Run the playbook.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cd ~/apache-basic-playbook
ansible-playbook -i ../hosts site.yml --private-key=~/.ssh/<span class="prefix">example</span>-tower</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_verify_your_output">Step 2: Verify your output</h3>
<div class="paragraph">
<p>If successful, your standard output should look similar to the figure below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/workshops/ansible_tower_azure/images/stdout_3.png" alt="ansible-basic-playbook role-based stdout"/>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_4_review">Section 4: Review</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You should now have a completed playbook, <code>site.yml</code> with a single role called <code>apache-simple</code>.  The advantage of structuring your playbook into roles is that you can now add new roles to the playbook using Ansible Galaxy or simply writing your own.  In addition, roles simplify changes to variables, tasks, templates, etc.</p>
</div>
<div class="paragraph">
<script type="text/javascript">

function replaceclasstext(cname,cvalue) {
    var x = document.getElementsByClassName(cname);
    var i;
    for (i = 0; i < x.length; i++) {
        x[i].innerHTML= cvalue;
    }
}

function setCookie(cname,cvalue) {
    var date = new Date();
    date.setTime(date.getTime() + 86400000);
    var expires =  date.toGMTString();
    document.cookie = cname + "=" + cvalue + ";expires=" + expires + ";path=/";
}

function getCookie(cname) {
    var name = cname + "=";
    var decodedCookie = decodeURIComponent(document.cookie);
    var ca = decodedCookie.split(';');
    for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

function loadVariables() {

    var userid=getCookie("userid");
    var prefix=getCookie("prefix");
    var domain=getCookie("domain");
    var region=getCookie("region");

    if (userid != "") {
    	document.getElementById("userid").value = userid;
    }
    if (prefix != "") {
    	document.getElementById("prefix").value = prefix;
    } else {
    	document.getElementById("prefix").value = "example";
    }
    if (region != "") {
      document.getElementById("region").value = region;
    } else {
      document.getElementById("region").value = "example";
    }
    if (domain != "") {
    	document.getElementById("domain").value = domain;
        replaceclasstext("domain",domain)
        replaceclasstext("prefix",prefix)
        replaceclasstext("userid",userid)
        replaceclasstext("region",region)
    }
}

function defaultVariables() {

    document.getElementById("userid").value = "0";
    document.getElementById("prefix").value = "example";
    document.getElementById("domain").value = "cloudapp.azure.com";
    document.getElementById("region").value = "example";
    setCookie("userid", document.getElementById("userid").value);
    setCookie("prefix", document.getElementById("prefix").value);
    setCookie("domain", document.getElementById("domain").value);
    setCookie("region", document.getElementById("region").value);

    var userid = document.getElementById("userid").value;
    var prefix = document.getElementById("prefix").value;
    var domain = document.getElementById("domain").value;
    var region = document.getElementById("region").value;
    var fqdn = userid + "." + prefix + "." + domain;

    replaceclasstext("domain",domain)
    replaceclasstext("prefix",prefix)
    replaceclasstext("userid",userid)
    replaceclasstext("region",region)

}

function setupWorkshop() {
    var userid = document.getElementById("userid").value;
    var prefix = document.getElementById("prefix").value;
    var domain = document.getElementById("domain").value;
    var region = document.getElementById("region").value;

    setCookie("userid", userid);
    setCookie("prefix", prefix);
    setCookie("domain", domain);
    setCookie("region", region);

    replaceclasstext("domain",domain)
    replaceclasstext("prefix",prefix)
    replaceclasstext("userid",userid)
    replaceclasstext("region",region)

}
</script>
<hr>
<h3>Workshop Details</h3>
<table border=1>
<tr>
<td>
  <table><tr><td>Student ID: </td><td>
  <select id="userid">
    <option value="0">0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
    <option value="25">25</option>
    <option value="26">26</option>
    <option value="27">27</option>
    <option value="28">28</option>
    <option value="29">29</option>
    <option value="30">30</option>
    <option value="31">31</option>
    <option value="32">32</option>
    <option value="33">33</option>
    <option value="34">34</option>
    <option value="35">35</option>
    <option value="36">36</option>
    <option value="37">37</option>
    <option value="38">38</option>
    <option value="39">39</option>
    <option value="40">40</option>
    <option value="41">41</option>
    <option value="42">42</option>
    <option value="43">43</option>
    <option value="44">44</option>
    <option value="45">45</option>
    <option value="46">46</option>
    <option value="47">47</option>
    <option value="48">48</option>
    <option value="49">49</option>
    <option value="50">50</option>
  </select>
  </td></tr></table>
</td>
<td>
  <table><tr><td>Workshop: </td><td>
   <input id="prefix" type="text" size=8>
  </td></tr></table>
</td>
<td>
  <table><tr><td>Region: </td><td>
   <input id="region" type="text" size=8>
  </td></tr></table>
</td>
<td>
  <select id="domain">
    <option value="cloudapp.azure.com">cloudapp.azure.com</option>
  </select>
</td>
<td>
  <button onclick="setupWorkshop()">Enter</button><br>
  <button onclick="defaultVariables()">Default</button>
</td>
</tr>
</table>
<table>
<tr>
<td align=right><b>Domain: </b></td>
<td><span class="domain"></span></td>
<td rowspan=3>
<img src="/images/Logo-Red_Hat-C-Standard-RGB-small.png" onload=loadVariables()>
</td>
</tr>
<tr>
<td align=right><b>Workshop Name: </b></td>
<td><span class="prefix"></span></td>
</tr>
<tr>
<td align=right><b>Region: </b></td>
<td><span class="region"></span></td>
</tr>
<tr>
<td align=right><b>User ID: </b></td>
<td><span class="userid"></span></td>
</tr>
</table>
<hr>


</div>
</div>
</div>


    








<nav>
  <ul class="pager">
    
    
    <li class="previous">
      <a href="/workshops/ansible_tower_azure/exercise1.4/">&larr; Previous: Exercise 1.4 - Running the apache-basic-playbook</a>
    </li>
    
    
    
    
    <li class="next">
      <a href="/workshops/ansible_tower_azure/exercise2.0/">Next: Exercise 2.0 - Installing Ansible Tower &rarr;</a>
    </li>
    
    
  </ul>
</nav>

    <p class="text-center">
      
      <a href="/workshops/ansible_tower_azure">Return to Workshop</a>
    </p>
  </div>
</div>

    <div id="page-footer" class="container">
      <p class="text-center">
        Copyright &copy; 2025 Red Hat, Inc.
      </p>
    </div>
    <script type="text/javascript">
      if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
      }
    </script>
  </body>
</html>
