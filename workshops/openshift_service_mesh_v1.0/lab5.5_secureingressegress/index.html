<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Security - Securing Ingress and Egress | Red Hat | Public Sector</title>

    
    
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly.min.css" />
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly-additions.min.css" />

    
    <link rel="stylesheet" href="/node_modules/highlight.js/styles/darkula.css" />

    
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/asciidoc.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <link rel="stylesheet" href="/css/toastr.min.css" />

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DL741MBBZQ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DL741MBBZQ');
    </script>

    
    <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery/dist/jquery.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/c3/c3.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/d3/d3.min.js"></script>

    
    
    <script src="/node_modules/patternfly/node_modules/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/drmonty-datatables-colvis/js/dataTables.colVis.js"></script>
    <script src="/node_modules/patternfly/node_modules/datatables.net-colreorder/js/dataTables.colReorder.js"></script>

    
    
    <script src="/node_modules/patternfly/dist/js/patternfly.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-combobox/js/bootstrap-combobox.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/moment/min/moment.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-select/dist/js/bootstrap-select.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-switch/dist/js/bootstrap-switch.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-treeview/dist/bootstrap-treeview.min.js"></script>

    
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery-match-height/dist/jquery.matchHeight-min.js"></script>
    
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/clip.js"></script>

    
    <script src="/js/toastr.min.js"></script>

    
    <script src="/node_modules/highlight.js/lib/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body class="">
    

<nav class="navbar navbar-default navbar-inverse navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
      <svg width=150 height=auto id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145"><defs><style>.cls-1{fill:#e00;}.cls-2{fill:#fff;}</style></defs><path class="cls-1" d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/><path d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/><path class="cls-2" d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/></svg>
      </a>
    </div>
    <div class="collapse navbar-collapse navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        
        
          
            <li>
              <a href="/">Home</a>
            </li>
          
        
          
            <li>
              <a href="/about/">About</a>
            </li>
          
        
          
            <li>
              <a href="/contact/">Contact</a>
            </li>
          
        
          
            <li>
              <a href="https://www.redhat.com/en/events">Events</a>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Workshops <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/agile_integrations_ci/">Agile Integrations Workshop - Citizen Integrator</a>
                  </li>
                
                  <li>
                    <a href="/workshops/agile_integrations_dev/">Agile Integrations Workshop - Developer</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_automation/">Ansible Automation Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_tower_intro/">Ansible Tower - an Introduction</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_container_intro/">Container Security - A Practical Introduction</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_101/">Containers 101 Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/secure_software_factory/">DevSecOps Workshop - Secure Software Factory</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_the_hard_way/">Linux Containers the Hard Way</a>
                  </li>
                
                  <li>
                    <a href="/workshops/strangling_the_monolith/">Microservices Workshop - Strangling the Monolith</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_4_101/">OpenShift 4 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_4_101_dynatrace/">OpenShift 4 101 w/Dynatrace</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_serverless/">OpenShift Serverless</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_service_mesh/">OpenShift Service Mesh</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhel_8/">Red Hat Enterprise Linux 8</a>
                  </li>
                
                  <li>
                    <a href="/workshops/selinux_policy/">SELinux Policy Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_service_mesh_v1.0/">zOpenShift Service Mesh</a>
                  </li>
                
              </ul>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                alpha <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/alpha/ansible_with_rhocp_edge/">Applied Ansible Automation - Containerized Edge Workshop</a>
                  </li>
                
              </ul>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Retired <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/ansible_tower_azure/">Ansible Tower Workshop on Azure</a>
                  </li>
                
                  <li>
                    <a href="/workshops/cloudforms41/">CloudForms Workshops</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_containers/">Container Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/jdv_dev/">JBoss Data Virtualization Development</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_101_dcmetromap/">OpenShift 101 - DC Metro Map Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_openshift/">OpenShift Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhosp_101/">Red Hat OpenStack Platform 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/source_to_image/">Source to Image</a>
                  </li>
                
              </ul>
            </li>
          
        
      </ul>
    </div>
  </div>
</nav>



<div class="jumbotron jumbotron-page text-center">
  <h1>Security - Securing Ingress and Egress</h1>
</div>

<div class="container">
  <div class="row">
    <p class="text-center">
      
      <a href="/workshops/openshift_service_mesh_v1.0">Return to Workshop</a>
    </p>

    








<nav>
  <ul class="pager">
    
    
    <li class="previous">
      <a href="/workshops/openshift_service_mesh_v1.0/lab5.4_authpolicy/">&larr; Previous: Security - Auth Policy</a>
    </li>
    
    
    
    
    <li class="next">
      <a href="/workshops/openshift_service_mesh_v1.0/fin/">Next: Fin. &rarr;</a>
    </li>
    
    
  </ul>
</nav>

    <h1 id="securing-ingress-and-egress">Securing Ingress and Egress</h1>
<p>In cases where strict security is required we need to configure specifics around securing ingress and egress traffic. Security around egress is often used to lock down and deny access to potentially harmful resources outside the network. Additionally, it is a good practice to prevent malicious activities from originating from the cluster.</p>
<p>You are probably already familiar with basic ingress security concepts. Essentially, only exposing particular services to be accessible from outside the cluster and using basic TLS/SSL. The service mesh has an ingress router (a standalone Envoy) running by default and we already configured it during the &ldquo;Deploying an App into the Service Mesh&rdquo; lab.</p>
<p>An even better way to track/lockdown inbound traffic for our microservices is to leverage API management in front of all the API services. We could do this with a service mesh plugin for 3scale. We aren&rsquo;t going to walk through it today - if that&rsquo;s something that interest you, <a href="https://docs.openshift.com/container-platform/4.3/service_mesh/threescale_adapter/threescale-adapter.html">read more about that here</a> <a href="https://www.redhat.com/en/technologies/jboss-middleware/3scale">and here</a>.</p>
<p>For now let&rsquo;s lockdown egress.</p>
<h2 id="lock-down-egress">Lock Down Egress</h2>
<p>In this example we are going to restrict access to external endpoints to only approved hosts. The service mesh has an egress router (a standalone Envoy) running by default and we just need to configure it.</p>
<p>The <code>ServiceMeshControlPlane</code> custom resource we used to install Istio has a <code>global</code> config which allows control of the defaults for egress security. That looks like this:</p>
<pre tabindex="0"><code># Set the default behavior of the sidecar for handling outbound traffic from the application:
# ALLOW_ANY - outbound traffic to unknown destinations will be allowed, in case there are no
#   services or ServiceEntries for the destination port
# REGISTRY_ONLY - restrict outbound traffic to services defined in the service registry as well
#   as those defined through ServiceEntries  
outboundTrafficPolicy:
  mode: REGISTRY_ONLY
</code></pre><p>The mesh you&rsquo;re using in this workshop should already have the mode set to <code>REGISTRY_ONLY</code>. Let&rsquo;s verify that in the auto-generated config map:</p>
<blockquote>
<i class="fa fa-terminal"></i>
Run this command and look for outboundTrafficPolicy
</blockquote>
<pre tabindex="0"><code>oc describe cm/istio -n istio-system
</code></pre><br>
<blockquote>
<i class="fa fa-terminal"></i>
Now let's verify it's working - Run this command to scrape some data:
</blockquote>
<pre tabindex="0"><code>oc run curl-scraper-1 -i --restart=Never --image=appropriate/curl --timeout=30s -- -v context-scraper:8080/scrape/custom_search?term==skynet
</code></pre><p>We should get an output similar to the one below, with error of ECONNRESET:</p>
<pre tabindex="0"><code>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 172.30.83.172...
* TCP_NODELAY set
* Connected to context-scraper (172.30.83.172) port 8080 (#0)
&gt; GET /scrape/custom_search?term==skynet HTTP/1.1
&gt; Host: context-scraper:8080
&gt; User-Agent: curl/7.59.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 500 Internal Server Error
&lt; x-powered-by: Express
&lt; access-control-allow-origin: *
&lt; content-type: application/json; charset=utf-8
&lt; content-length: 682
&lt; etag: W/&#34;2aa-5GVBTSjlqUqotSZU1yZmOHgTWC0&#34;
&lt; date: Thu, 07 May 2020 23:02:45 GMT
&lt; x-envoy-upstream-service-time: 36
&lt; server: istio-envoy
&lt; x-envoy-decorator-operation: context-scraper.user3.svc.cluster.local:8080/*
&lt;
{ [682 bytes data]
100   682  100   682    0     0  16634      0 --:--:-- --:--:-- --:--:-- 16634
* Connection #0 to host context-scraper left intact
{&#34;oops&#34;:{&#34;name&#34;:&#34;RequestError&#34;,&#34;message&#34;:&#34;Error: read ECONNRESET&#34;,&#34;cause&#34;:{&#34;errno&#34;:&#34;ECONNRESET&#34;,&#34;code&#34;:&#34;ECONNRESET&#34;,&#34;syscall&#34;:&#34;read&#34;},&#34;error&#34;:{&#34;errno&#34;:&#34;ECONNRESET&#34;,&#34;code&#34;:&#34;ECONNRESET&#34;,&#34;syscall&#34;:&#34;read&#34;},&#34;options&#34;:{&#34;method&#34;:&#34;GET&#34;,&#34;uri&#34;:&#34;https://www.googleapis.com/customsearch/v1/siterestrict&#34;,&#34;qs&#34;:{&#34;key&#34;:&#34;AIzaSyDRdgirA2Pakl4PMi7t-8LFfnnjEFHnbY4&#34;,&#34;cx&#34;:&#34;005627457786250373845:lwanzyzfwji&#34;,&#34;q&#34;:&#34;=skynet&#34;},&#34;headers&#34;:{&#34;user-agent&#34;:&#34;curl/7.59.0&#34;,&#34;x-request-id&#34;:&#34;d78cf7b9-0010-9ecf-b520-f3d6a83376a0&#34;,&#34;x-b3-traceid&#34;:&#34;21b58b1725b20a81f914496d9a55455d&#34;,&#34;x-b3-spanid&#34;:&#34;f914496d9a55455d&#34;,&#34;x-b3-sampled&#34;:&#34;1&#34;},&#34;json&#34;:true,&#34;simple&#34;:true,&#34;resolveWithFullResponse&#34;:false,&#34;transform2xxOnly&#34;:false}}}
</code></pre><p>Which is curl (running in a pod in our project) trying to talk to the context-scraper microservice (in the mesh). You can see from the error details that the service is trying to get out to googleapis.com but fails.</p>
<br>
<blockquote>
<i class="fa fa-desktop"></i>
(Optional) If you were to look at Kiali now you'd see the request going to a blackhole:
</blockquote>
<p><img src="../images/kiali-egress-blackhole.png" width="1024" class="screenshot"><br/></p>
<br>
<h2 id="allow-egress-to-approved-hosts">Allow Egress to Approved Hosts</h2>
<p>Now we will be using an Istio API object of type <a href="https://istio.io/docs/concepts/traffic-management/#service-entries">ServiceEntry</a> to allow controlled egress. After you add this ServiceEntry, our microservices (via their Envoy sidecars) can send traffic to the specified external service as if it was a service in your mesh.</p>
<p>Our ServiceEntry looks like this:</p>
<pre tabindex="0"><code>apiVersion: networking.istio.io/v1alpha3
kind: ServiceEntry
metadata:
  name: context-scraper-egress
spec:
  hosts:
  - www.googleapis.com
  ports:
  - number: 443
    name: https
    protocol: HTTPS
  resolution: DNS
  location: MESH_EXTERNAL
</code></pre><br>
<blockquote>
<i class="fa fa-terminal"></i>
Apply it with the following command:
</blockquote>
<pre tabindex="0"><code>oc apply -f ./istio-configuration/serviceentry-googleapis.yaml
</code></pre><br>
<blockquote>
<i class="fa fa-terminal"></i>
Run a new curl job to try scrape some data again:
</blockquote>
<pre tabindex="0"><code>oc run curl-scraper-2 -i --restart=Never --image=appropriate/curl --timeout=30s -- context-scraper:8080/scrape/custom_search?term==skynet
</code></pre><p>Now we should get an output similar to the one below - showing results:</p>
<pre tabindex="0"><code>custom_search?term==skynet
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[{&#34;link&#34;:&#34;https://www.reddit.com/r/movies/comments/1jqo8m/in_the_terminator_franchise_what_does_skynet/&#34;,&#34;title&#34;:&#34;In the Terminator franchise, what does Skynet actually want? : movies&#34;,&#34;snippet&#34;:&#34;Skynet perceived this as an attack and came to the conclusion that all of \nhumanity would attempt to destroy it. To defend itself, Skynet launched nuclear \nmissiles ...&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/incremental_games/comments/akfdz3/skynet_in_alpha_v2_10min_feedback_welcome/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcSq88CbTfa-lnWG4n7Y3xEVP4mD4A66tKWsBRRKJi7uPmPhacMeeVuexYI&#34;,&#34;width&#34;:&#34;310&#34;,&#34;height&#34;:&#34;163&#34;}],&#34;title&#34;:&#34;Skynet. In Alpha v2 (~10min). Feedback welcome ...&#34;,&#34;snippet&#34;:&#34;r/incremental_games: This subreddit is for lovers of games that feature an \nincremental mechanism, such as unlocking progressively more powerful …&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/DeepBrainChain/comments/8rar5b/deepbrain_chain_launches_skynet_project/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQrwBIFnOZygv1EKJ1z7TnNeWIfom8Kp0Zgbs6YvM4DXYP0zvra6GNCnh0&#34;,&#34;width&#34;:&#34;225&#34;,&#34;height&#34;:&#34;225&#34;}],&#34;title&#34;:&#34;DeepBrain Chain Launches &#39;&#39;Skynet Project&#39;&#39;— Recruiting AI ...&#34;,&#34;snippet&#34;:&#34;To achieve that, DeepBrain Chain Foundation will activate the &#39;&#39;Skynet Project&#39;&#39; \non June 15th Beijing time and, recruit AI computing power from the globe.&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/OutOfTheLoop/comments/24obct/what_is_skynet_and_why_do_people_reference_it/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQrwBIFnOZygv1EKJ1z7TnNeWIfom8Kp0Zgbs6YvM4DXYP0zvra6GNCnh0&#34;,&#34;width&#34;:&#34;225&#34;,&#34;height&#34;:&#34;225&#34;}],&#34;title&#34;:&#34;What is Skynet and why do people reference it often? : OutOfTheLoop&#34;,&#34;snippet&#34;:&#34;It is a reference to the movie Terminator. Skynet is the fictional computer entity \nwhich becomes self-aware and takes over all other computers it is linked to. Then\n, ...&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/linux/comments/2vyhr6/apparently_terminator_runs_linux_version/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQSpw8eEnexhK7SlaTQPtFUIqBZYb-Qt5Pa28s8fPAMI4uydC7nmbCc_bU&#34;,&#34;width&#34;:&#34;300&#34;,&#34;height&#34;:&#34;168&#34;}],&#34;title&#34;:&#34;Apparently Terminator runs Linux version 4.1.15-1.1381 ...&#34;,&#34;snippet&#34;:&#34;The real question is why skynet bothers making visuals displays for data. \nContinue this thread. level 1. ptrwis. 177 points · 5 years ago. It&#39;s systemd, \nevolved and ...&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/siacoin/comments/elqcyi/taek_teases_skynet_huge_news_in_the_pipeline/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRcez9TMXJ9S-onsmNDs7ZxIJEdM8hhhneEJgjELCbomsACnBA2ywgnPvo&#34;,&#34;width&#34;:&#34;152&#34;,&#34;height&#34;:&#34;331&#34;}],&#34;title&#34;:&#34;Taek teases Skynet - huge news in the pipeline, game-changing ...&#34;,&#34;snippet&#34;:&#34;r/siacoin: Sia is a cryptocurrency engineered to provide industrial grade cloud \nstorage at consumer prices.&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/incremental_games/comments/98oj1p/skynet_in_alpha_5min_feedback_welcome/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcSq88CbTfa-lnWG4n7Y3xEVP4mD4A66tKWsBRRKJi7uPmPhacMeeVuexYI&#34;,&#34;width&#34;:&#34;310&#34;,&#34;height&#34;:&#34;163&#34;}],&#34;title&#34;:&#34;Skynet. In Alpha (~5min). Feedback welcome : incremental_games&#34;,&#34;snippet&#34;:&#34;r/incremental_games: This subreddit is for lovers of games that feature an \nincremental mechanism, such as unlocking progressively more powerful …&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/AskScienceFiction/comments/3msulj/terminator_why_doesnt_skynet_use_bio_weapons/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQrwBIFnOZygv1EKJ1z7TnNeWIfom8Kp0Zgbs6YvM4DXYP0zvra6GNCnh0&#34;,&#34;width&#34;:&#34;225&#34;,&#34;height&#34;:&#34;225&#34;}],&#34;title&#34;:&#34;[Terminator] why doesn&#39;t skynet use bio weapons? : AskScienceFiction&#34;,&#34;snippet&#34;:&#34;When skynet came online initially it calculated that humanities greatest threat \nwas itself and so it launched our best weapons against Americas most well ...&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/AskScienceFiction/comments/9yp425/terminator_why_does_skynet_only_send_robots_back/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQrwBIFnOZygv1EKJ1z7TnNeWIfom8Kp0Zgbs6YvM4DXYP0zvra6GNCnh0&#34;,&#34;width&#34;:&#34;225&#34;,&#34;height&#34;:&#34;225&#34;}],&#34;title&#34;:&#34;[Terminator] Why does Skynet only send robots back within one life ...&#34;,&#34;snippet&#34;:&#34;Skynet&#39;s existence exists as a mobius strip in time, centered around Judgement \nDay. Judgement Day is inevitable, and nothing can stop it from taking place.&#34;},{&#34;link&#34;:&#34;https://www.reddit.com/r/AskScienceFiction/comments/7q7766/terminator_why_doesnt_skynet_just_poison_the/&#34;,&#34;thumbnail&#34;:[{&#34;src&#34;:&#34;https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQrwBIFnOZygv1EKJ1z7TnNeWIfom8Kp0Zgbs6YvM4DXYP0zvra6GNCnh0&#34;,&#34;width&#34;:&#34;225&#34;,&#34;height&#34;:&#34;225&#34;}],&#34;title&#34;:&#34;[Terminator] Why doesn&#39;t Skynet just poison the atmosphere if they ...&#34;,&#34;snippet&#34;:&#34;Skynet uses Terminators because, so far as it is concerned100  5049  100  5049    0     0   9350      0 --:--:-- --:--:-- --:--:--  9332e humans. It&#39;s goal is to \nfulfill ..
</code></pre><br>
<p>If we wanted to we could now configure virtual services and destination rules to control traffic to the service entry in a more granular way. The same way we configured traffic for the other services in our mesh.</p>
<p>And Kiali tracks this ServiceEntry too, let&rsquo;s look at the graph to see how things are visualized.</p>
<br>
<blockquote>
<i class="fa fa-desktop"></i>
(Optional) And now, if your were to open the graph view of Kiali you'd see the external service represented
<br>
</blockquote>
<p><img src="../images/kiali-egress.png" width="1024" class="screenshot"><br/></p>
<br>
<h1 id="summary">Summary</h1>
<p>Congrats! You successfully locked down egress to known external hosts and configured tracking of that via the Service Mesh. This is an advanced capability of the mesh - and you can read more about managing <a href="https://istio.io/docs/tasks/traffic-management/ingress/">ingress here</a> and <a href="https://istio.io/docs/tasks/traffic-management/egress/">egress here</a>.</p>
<p>A few key highlights are:</p>
<ul>
<li>We can lock down egress traffic to only approved external endpoints or services</li>
<li>We can lock down ingress traffic to only approved external endpoints or services</li>
<li>We can secure ingress traffic via standard TLS or mutual TLS</li>
<li>We can leverage 3scale API management to limit who can access exposed APIs and how</li>
</ul>
<style>

 
.modal {
  display: none;  
  position: fixed;  
  z-index: 1;  
  left: 0;
  top: 0;
  width: 100%;  
  height: 100%;  
  overflow: auto;  
  background-color: rgb(0,0,0);  
  background-color: rgba(0,0,0,0.4);  
  -webkit-animation-name: fadeIn;  
  -webkit-animation-duration: 0.4s;
  animation-name: fadeIn;
  animation-duration: 0.4s
}

 
.modal-content {
  position: fixed;
  bottom: 0;
  background-color: #fefefe;
  width: 100%;
  -webkit-animation-name: slideIn;
  -webkit-animation-duration: 0.4s;
  animation-name: slideIn;
  animation-duration: 0.4s
}

 
.close {
  color: white;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}

.modal-header {
  padding: 2px 16px;
  background-color: #000000;
  color: white;
}

.modal-body {padding: 2px 16px;}

.modal-footer {
  padding: 2px 16px;
  background-color: #000000;
  color: white;
}

 
@-webkit-keyframes slideIn {
  from {bottom: -300px; opacity: 0}
  to {bottom: 0; opacity: 1}
}

@keyframes slideIn {
  from {bottom: -300px; opacity: 0}
  to {bottom: 0; opacity: 1}
}

@-webkit-keyframes fadeIn {
  from {opacity: 0}
  to {opacity: 1}
}

@keyframes fadeIn {
  from {opacity: 0}
  to {opacity: 1}
}
</style>

<div id="myModal" class="modal">

  
  <div class="modal-content">
    <div class="modal-header">
      <span class="close">&times;</span>
      <h3>Workshop Details</h3>
    </div>
    <div class="modal-body">
<div class="row">
  <div class="col-lg-4 col-md-5 col-sm-12" id="workshopFooterDetails">
    <table>
      <tr>
        <td class="text-right"><b>Domain</b></td>
        <td><span class="domain"></span></td>
        <td rowspan="3">
        <img src="/images/Logo-Red_Hat-C-Standard-RGB-small.png" alt="Red Hat Logo" />
        </td>
      </tr>
      <tr>
        <td class="text-right"><b>Workshop</b></td>
        <td><span class="prefix"></span></td>
      </tr>
      <tr>
        <td class="text-right"><b>Student ID</b></td>
        <td><span class="userid"></span></td>
      </tr>
    </table>
  </div>
  <div class="col-lg-8 col-md-7 col-sm-12">
    <form id="footerForm" onsubmit="return false;" class="row" style="padding: 1.75rem 0 0 0;">
      <div class="form-group col-sm-6 col-md-6 col-lg-2">
        <label for="userid">Student ID</label>
        <select id="userid" name="userid">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10</option>
          <option value="11">11</option>
          <option value="12">12</option>
          <option value="13">13</option>
          <option value="14">14</option>
          <option value="15">15</option>
          <option value="16">16</option>
          <option value="17">17</option>
          <option value="18">18</option>
          <option value="19">19</option>
          <option value="20">20</option>
          <option value="21">21</option>
          <option value="22">22</option>
          <option value="23">23</option>
          <option value="24">24</option>
          <option value="25">25</option>
          <option value="26">26</option>
          <option value="27">27</option>
          <option value="28">28</option>
          <option value="29">29</option>
          <option value="30">30</option>
          <option value="31">31</option>
          <option value="32">32</option>
          <option value="33">33</option>
          <option value="34">34</option>
          <option value="35">35</option>
          <option value="36">36</option>
          <option value="37">37</option>
          <option value="38">38</option>
          <option value="39">39</option>
          <option value="40">40</option>
          <option value="41">41</option>
          <option value="42">42</option>
          <option value="43">43</option>
          <option value="44">44</option>
          <option value="45">45</option>
          <option value="46">46</option>
          <option value="47">47</option>
          <option value="48">48</option>
          <option value="49">49</option>
          <option value="50">50</option>
          <option value="51">51</option>
          <option value="52">52</option>
          <option value="53">53</option>
          <option value="54">54</option>
          <option value="55">55</option>
          <option value="56">56</option>
          <option value="57">57</option>
          <option value="58">58</option>
          <option value="59">59</option>
          <option value="60">60</option>
          <option value="61">61</option>
          <option value="62">62</option>
          <option value="63">63</option>
          <option value="64">64</option>
          <option value="65">65</option>
          <option value="66">66</option>
          <option value="67">67</option>
          <option value="68">68</option>
          <option value="69">69</option>
          <option value="70">70</option>
          <option value="71">71</option>
          <option value="72">72</option>
          <option value="73">73</option>
          <option value="74">74</option>
          <option value="75">75</option>
          <option value="76">76</option>
          <option value="77">77</option>
          <option value="78">78</option>
          <option value="79">79</option>
          <option value="80">80</option>
          <option value="81">81</option>
          <option value="82">82</option>
          <option value="83">83</option>
          <option value="84">84</option>
          <option value="85">85</option>
          <option value="86">86</option>
          <option value="87">87</option>
          <option value="88">88</option>
          <option value="89">89</option>
          <option value="90">90</option>
          <option value="91">91</option>
          <option value="92">92</option>
          <option value="93">93</option>
          <option value="94">94</option>
          <option value="95">95</option>
          <option value="96">96</option>
          <option value="97">97</option>
          <option value="98">98</option>
          <option value="99">99</option>
          <option value="100">100</option>
          <option value="101">101</option>
          <option value="102">102</option>
          <option value="103">103</option>
          <option value="104">104</option>
          <option value="105">105</option>
          <option value="106">106</option>
          <option value="107">107</option>
          <option value="108">108</option>
          <option value="109">109</option>
          <option value="110">110</option>
          <option value="111">111</option>
          <option value="112">112</option>
          <option value="113">113</option>
          <option value="114">114</option>
          <option value="115">115</option>
          <option value="116">116</option>
          <option value="117">117</option>
          <option value="118">118</option>
          <option value="119">119</option>
          <option value="120">120</option>
          <option value="121">121</option>
          <option value="122">122</option>
          <option value="123">123</option>
          <option value="124">124</option>
          <option value="125">125</option>
          <option value="126">126</option>
          <option value="127">127</option>
          <option value="128">128</option>
          <option value="129">129</option>
          <option value="130">130</option>
          <option value="131">131</option>
          <option value="132">132</option>
          <option value="133">133</option>
          <option value="134">134</option>
          <option value="135">135</option>
          <option value="136">136</option>
          <option value="137">137</option>
          <option value="138">138</option>
          <option value="139">139</option>
          <option value="140">140</option>
          <option value="141">141</option>
          <option value="142">142</option>
          <option value="143">143</option>
          <option value="144">144</option>
          <option value="145">145</option>
          <option value="146">146</option>
          <option value="147">147</option>
          <option value="148">148</option>
          <option value="149">149</option>
          <option value="150">150</option>
          <option value="151">151</option>
          <option value="152">152</option>
          <option value="153">153</option>
          <option value="154">154</option>
          <option value="155">155</option>
          <option value="156">156</option>
          <option value="157">157</option>
          <option value="158">158</option>
          <option value="159">159</option>
          <option value="160">160</option>
          <option value="161">161</option>
          <option value="162">162</option>
          <option value="163">163</option>
          <option value="164">164</option>
          <option value="165">165</option>
          <option value="166">166</option>
          <option value="167">167</option>
          <option value="168">168</option>
          <option value="169">169</option>
          <option value="170">170</option>
          <option value="171">171</option>
          <option value="172">172</option>
          <option value="173">173</option>
          <option value="174">174</option>
          <option value="175">175</option>
          <option value="176">176</option>
          <option value="177">177</option>
          <option value="178">178</option>
          <option value="179">179</option>
          <option value="180">180</option>
          <option value="181">181</option>
          <option value="182">182</option>
          <option value="183">183</option>
          <option value="184">184</option>
          <option value="185">185</option>
          <option value="186">186</option>
          <option value="187">187</option>
          <option value="188">188</option>
          <option value="189">189</option>
          <option value="190">190</option>
          <option value="191">191</option>
          <option value="192">192</option>
          <option value="193">193</option>
          <option value="194">194</option>
          <option value="195">195</option>
          <option value="196">196</option>
          <option value="197">197</option>
          <option value="198">198</option>
          <option value="199">199</option>
          <option value="200">200</option>
        </select>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-4">
        <label for="domain">Domain</label>
        <select id="domain" name="domain">
          <option value="rhnaps.io">rhnaps.io</option>
          <option value="redhatgov.io">redhatgov.io</option>
          <option value="az.redhatgov.io">az.redhatgov.io</option>
          <option value="redhat-fierce.io">redhat-fierce.io</option>
          <option value="fiercesw.network">fiercesw.network</option>
          <option value="rhtps.io">rhtps.io</option>
          <option value="openshiftworkshop.com">openshiftworkshop.com</option>
          <option value="redhatpsmwsa.com">redhatpsmwsa.com</option>
          <option value="open.redhat.com">open.redhat.com</option>
          <option value="opentlc.com">opentlc.com</option>
          <option value="aroapp.io">aroapp.io</option>
          <option value="danclark.io">danclark.io</option>
        </select>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-3">
        <label for="prefix">Workshop</label>
        <input id="prefix" name="prefix" type="text" size="16" class="form-control" placeholder="example" onkeyup="this.value = this.value.toLowerCase();this.value = this.value.replace(/[^-.a-zA-Z0-9]/g, '');"/>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-3">
        <button type="submit" class="btn btn-primary form-control" style="margin-bottom:1rem;">Enter</button>
        <button type="reset" class="btn btn-default form-control">Default</button>
      </div>
    </form>
  </div>
</div>

    </div>
    <div class="modal-footer">
      <h3></h3>
    </div>
  </div>

</div>

<script type="text/javascript" src="/node_modules/js-cookie/src/js.cookie.js"></script>
<script type="text/javascript">

  
  var Cookies2 = Cookies.noConflict();

  var cookiePathArr = cleanArray(window.location.pathname.split('/'));
  var cookiePath = '/' + cookiePathArr[0] + '/' + cookiePathArr[1] + '/';

  function cleanArray(actual) {
    var newArray = new Array();
    for (var i = 0; i < actual.length; i++) {
      if (actual[i]) {
        newArray.push(actual[i]);
      }
    }
    return newArray;
  }
  function replaceClassText() {
    jQuery("span.domain").html(Cookies2.get("domain"));
    jQuery("span.userid").html(Cookies2.get("userid"));
    jQuery("span.prefix").html(Cookies2.get("prefix"));
  }
  function pageLoadWorkshopFooterTest() {
    
    if (Cookies2.get("domain") === undefined) {
      resetWorkshopFooter();
    }
    else {
      replaceClassText();
      setWorkshopFooterInputValues()
    }
  }
  function setWorkshopFooterData() {
    
    Cookies2.set("domain", jQuery("select#domain").val(), { path: cookiePath, expires: 7 } );
    Cookies2.set("prefix", jQuery("input#prefix").val().replace(/[^-.a-zA-Z0-9]/g, ''), { path: cookiePath, expires: 7 } );
    Cookies2.set("userid", jQuery("select#userid").val(), { path: cookiePath, expires: 7 } );
    replaceClassText();
    modal.style.display = "none";
  }
  function setWorkshopFooterInputValues() {
    jQuery("select#domain").val(Cookies2.get("domain"));
    jQuery("input#prefix").val(Cookies2.get("prefix"));
    jQuery("select#userid").val(Cookies2.get("userid"));
  }
  function resetWorkshopFooter() {
    
    jQuery("select#domain, select#userid").prop("selectedIndex", 0);
    jQuery("input#prefix").val(jQuery("input#prefix").attr('placeholder'));
    
    Cookies2.set("domain", jQuery("select#domain option").first().val(), { path: cookiePath, expires: 7 } ); 
    Cookies2.set("userid", jQuery("select#userid option").first().val(), { path: cookiePath, expires: 7 } ); 
    Cookies2.set("prefix", jQuery("input#prefix").val(), { path: cookiePath, expires: 7 } );
    
    
    replaceClassText();
  }




  function updateFooter(e){
    fieldName = '';

    switch(e.id) {
      case 'userid':
        fieldName = 'User Id';
        break;
      case 'domain':
        fieldName = 'Domain';
        break;
      case 'prefix':
        fieldName = 'Workshop';
        break;
      default:
        fieldName = 'unknown';
    }
    setWorkshopFooterData();
    toastr["success"](fieldName + " set to " + e.value);
  }

  jQuery(document).ready(function() {
    pageLoadWorkshopFooterTest();


    
    var input = document.getElementById("prefix");

    
    input.addEventListener("keyup", function(event) {
      
      if (event.keyCode === 13) {
        
        event.preventDefault();
        
        
        updateFooter(input);
      }
    });


    jQuery("form#footerForm").submit(function() {
      setWorkshopFooterData();
      return false; 
    });

    jQuery("form#footerForm").bind("reset", function() {
      resetWorkshopFooter();
      return true;
    });

    return false;
  });

</script>

<hr>
<h3>Workshop Details</h3>
    <table>
      <tr>
        <td class="text-right"><b>Domain</b></td>
        <td><span class="domain"></span></td>
        <td rowspan="3">
          <img src="/images/Logo-Red_Hat-C-Standard-RGB-small.png" alt="Red Hat Logo" />
        </td>
      </tr>
      <tr>
        <td class="text-right"><b>Workshop</b></td>
        <td><span class="prefix"></span></td>
      </tr>
      <tr>
        <td class="text-right"><b>Student ID</b></td>
        <td><span class="userid"></span></td>
      </tr>
    </table>
<button id="myBtn">Configure Workshop</button>
<hr>

<script>

var modal = document.getElementById("myModal");


var btn = document.getElementById("myBtn");


var span = document.getElementsByClassName("close")[0];


btn.onclick = function() {
  modal.style.display = "block";
}


span.onclick = function() {
  modal.style.display = "none";
}


window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>




    








<nav>
  <ul class="pager">
    
    
    <li class="previous">
      <a href="/workshops/openshift_service_mesh_v1.0/lab5.4_authpolicy/">&larr; Previous: Security - Auth Policy</a>
    </li>
    
    
    
    
    <li class="next">
      <a href="/workshops/openshift_service_mesh_v1.0/fin/">Next: Fin. &rarr;</a>
    </li>
    
    
  </ul>
</nav>

    <p class="text-center">
      
      <a href="/workshops/openshift_service_mesh_v1.0">Return to Workshop</a>
    </p>
  </div>
</div>

    <div id="page-footer" class="container">
      <p class="text-center">
        Copyright &copy; 2024 Red Hat, Inc.
      </p>
    </div>
    <script type="text/javascript">
      if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
      }
    </script>
  </body>
</html>
