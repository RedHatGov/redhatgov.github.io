<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Exercise 1.8 - Introduction to using buildah, podman and skopeo to work on containers | Red Hat | Public Sector</title>

    
    
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly.min.css" />
    <link rel="stylesheet" href="/node_modules/patternfly/dist/css/patternfly-additions.min.css" />

    
    <link rel="stylesheet" href="/node_modules/highlight.js/styles/darkula.css" />

    
    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/asciidoc.css" />
    <link rel="stylesheet" href="/css/custom.css" />
    <link rel="stylesheet" href="/css/toastr.min.css" />

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DL741MBBZQ"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-DL741MBBZQ');
    </script>

    
    <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery/dist/jquery.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/c3/c3.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/d3/d3.min.js"></script>

    
    
    <script src="/node_modules/patternfly/node_modules/datatables/media/js/jquery.dataTables.min.js"></script>
    <script src="/node_modules/patternfly/node_modules/drmonty-datatables-colvis/js/dataTables.colVis.js"></script>
    <script src="/node_modules/patternfly/node_modules/datatables.net-colreorder/js/dataTables.colReorder.js"></script>

    
    
    <script src="/node_modules/patternfly/dist/js/patternfly.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-combobox/js/bootstrap-combobox.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/moment/min/moment.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-select/dist/js/bootstrap-select.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-switch/dist/js/bootstrap-switch.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/patternfly-bootstrap-treeview/dist/bootstrap-treeview.min.js"></script>

    
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    
    <script src="/node_modules/patternfly/node_modules/jquery-match-height/dist/jquery.matchHeight-min.js"></script>
    
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/clip.js"></script>

    
    <script src="/js/toastr.min.js"></script>

    
    <script src="/node_modules/highlight.js/lib/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body class="">
    

<nav class="navbar navbar-default navbar-inverse navbar-fixed-top " role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">
      <svg width=150 height=auto id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 613 145"><defs><style>.cls-1{fill:#e00;}.cls-2{fill:#fff;}</style></defs><path class="cls-1" d="M127.47,83.49c12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42l-7.45-32.36c-1.72-7.12-3.23-10.35-15.73-16.6C124.89,8.69,103.76.5,97.51.5,91.69.5,90,8,83.06,8c-6.68,0-11.64-5.6-17.89-5.6-6,0-9.91,4.09-12.93,12.5,0,0-8.41,23.72-9.49,27.16A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33C22.27,52,.5,55,.5,74.22c0,31.48,74.59,70.28,133.65,70.28,45.28,0,56.7-20.48,56.7-36.65,0-12.72-11-27.16-30.83-35.78"/><path d="M160,72.07c1.73,8.19,1.73,9.05,1.73,10.13,0,14-15.74,21.77-36.43,21.77C78.54,104,37.58,76.6,37.58,58.49a18.45,18.45,0,0,1,1.51-7.33l3.66-9.06A6.43,6.43,0,0,0,42.53,44c0,9.22,36.3,39.45,84.94,39.45,12.51,0,30.61-2.58,30.61-17.46a14,14,0,0,0-.31-3.42Z"/><path class="cls-2" d="M579.74,92.8c0,11.89,7.15,17.67,20.19,17.67a52.11,52.11,0,0,0,11.89-1.68V95a24.84,24.84,0,0,1-7.68,1.16c-5.37,0-7.36-1.68-7.36-6.73V68.3h15.56V54.1H596.78v-18l-17,3.68V54.1H568.49V68.3h11.25Zm-53,.32c0-3.68,3.69-5.47,9.26-5.47a43.12,43.12,0,0,1,10.1,1.26v7.15a21.51,21.51,0,0,1-10.63,2.63c-5.46,0-8.73-2.1-8.73-5.57m5.2,17.56c6,0,10.84-1.26,15.36-4.31v3.37h16.82V74.08c0-13.56-9.14-21-24.39-21-8.52,0-16.94,2-26,6.1l6.1,12.52c6.52-2.74,12-4.42,16.83-4.42,7,0,10.62,2.73,10.62,8.31v2.73a49.53,49.53,0,0,0-12.62-1.58c-14.31,0-22.93,6-22.93,16.73,0,9.78,7.78,17.24,20.19,17.24m-92.44-.94h18.09V80.92h30.29v28.82H506V36.12H487.93V64.41H457.64V36.12H439.55ZM370.62,81.87c0-8,6.31-14.1,14.62-14.1A17.22,17.22,0,0,1,397,72.09V91.54A16.36,16.36,0,0,1,385.24,96c-8.2,0-14.62-6.1-14.62-14.09m26.61,27.87h16.83V32.44l-17,3.68V57.05a28.3,28.3,0,0,0-14.2-3.68c-16.19,0-28.92,12.51-28.92,28.5a28.25,28.25,0,0,0,28.4,28.6,25.12,25.12,0,0,0,14.93-4.83ZM320,67c5.36,0,9.88,3.47,11.67,8.83H308.47C310.15,70.3,314.36,67,320,67M291.33,82c0,16.2,13.25,28.82,30.28,28.82,9.36,0,16.2-2.53,23.25-8.42l-11.26-10c-2.63,2.74-6.52,4.21-11.14,4.21a14.39,14.39,0,0,1-13.68-8.83h39.65V83.55c0-17.67-11.88-30.39-28.08-30.39a28.57,28.57,0,0,0-29,28.81M262,51.58c6,0,9.36,3.78,9.36,8.31S268,68.2,262,68.2H244.11V51.58Zm-36,58.16h18.09V82.92h13.77l13.89,26.82H292l-16.2-29.45a22.27,22.27,0,0,0,13.88-20.72c0-13.25-10.41-23.45-26-23.45H226Z"/></svg>
      </a>
    </div>
    <div class="collapse navbar-collapse navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        
        
          
            <li>
              <a href="/">Home</a>
            </li>
          
        
          
            <li>
              <a href="/about/">About</a>
            </li>
          
        
          
            <li>
              <a href="/contact/">Contact</a>
            </li>
          
        
          
            <li>
              <a href="https://www.redhat.com/en/events">Events</a>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Workshops <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/agile_integrations_ci/">Agile Integrations Workshop - Citizen Integrator</a>
                  </li>
                
                  <li>
                    <a href="/workshops/agile_integrations_dev/">Agile Integrations Workshop - Developer</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_automation/">Ansible Automation Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/ansible_tower_intro/">Ansible Tower - an Introduction</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_container_intro/">Container Security - A Practical Introduction</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_101/">Containers 101 Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/secure_software_factory/">DevSecOps Workshop - Secure Software Factory</a>
                  </li>
                
                  <li>
                    <a href="/workshops/containers_the_hard_way/">Linux Containers the Hard Way</a>
                  </li>
                
                  <li>
                    <a href="/workshops/strangling_the_monolith/">Microservices Workshop - Strangling the Monolith</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_4_101/">OpenShift 4 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_4_101_dynatrace/">OpenShift 4 101 w/Dynatrace</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_serverless/">OpenShift Serverless</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_service_mesh/">OpenShift Service Mesh</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhel_8/">Red Hat Enterprise Linux 8</a>
                  </li>
                
                  <li>
                    <a href="/workshops/selinux_policy/">SELinux Policy Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_service_mesh_v1.0/">zOpenShift Service Mesh</a>
                  </li>
                
              </ul>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                alpha <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/alpha/ansible_with_rhocp_edge/">Applied Ansible Automation - Containerized Edge Workshop</a>
                  </li>
                
              </ul>
            </li>
          
        
          
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                Retired <b class="caret"></b>
              </a>
              <ul class="dropdown-menu">
                
                  <li>
                    <a href="/workshops/ansible_tower_azure/">Ansible Tower Workshop on Azure</a>
                  </li>
                
                  <li>
                    <a href="/workshops/cloudforms41/">CloudForms Workshops</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_containers/">Container Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/jdv_dev/">JBoss Data Virtualization Development</a>
                  </li>
                
                  <li>
                    <a href="/workshops/openshift_101_dcmetromap/">OpenShift 101 - DC Metro Map Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/security_openshift/">OpenShift Security Workshop</a>
                  </li>
                
                  <li>
                    <a href="/workshops/rhosp_101/">Red Hat OpenStack Platform 101</a>
                  </li>
                
                  <li>
                    <a href="/workshops/source_to_image/">Source to Image</a>
                  </li>
                
              </ul>
            </li>
          
        
      </ul>
    </div>
  </div>
</nav>



<div class="jumbotron jumbotron-page text-center">
  <h1>Exercise 1.8 - Introduction to using buildah, podman and skopeo to work on containers</h1>
</div>

<div class="container">
  <div class="row">
    <p class="text-center">
      
      <a href="/workshops/rhel_8">Return to Workshop</a>
    </p>

    








<nav>
  <ul class="pager">
    
    
    <li class="previous">
      <a href="/workshops/rhel_8/exercise1.7/">&larr; Previous: Exercise 1.7 - OpenSCAP Security Compliance Scanning</a>
    </li>
    
    
    
    
    <li class="next">
      <a href="/workshops/rhel_8/exercise1.9/">Next: Exercise 1.9 - System Roles with Ansible &rarr;</a>
    </li>
    
    
  </ul>
</nav>

    <div class="sect1">
<h2 id="_exercise_description">Exercise Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this exercise, you will build a custom application container utilizing the Red Hat Universal Base Image, customize that image and test the image functionality. After that you will use skopeo to transfer that image from your user local repository to the system repository and configure it to start at boot.</p>
</div>
<div class="paragraph">
<p>After completing this section, you will be able to build images from an existing base image using buildah and other host based tools. This is just scratching the surface of what  can be done with containers and the container tooling on RHEL 8, there are other workshops that focus exclusively on containers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_1_overview_of_buildah_podman_and_skopeo">Section 1: Overview of buildah, podman and skopeo</h2>
<div class="sectionbody">
<div class="paragraph">
<p><mark>Buildah</mark> specializes in building OCI images. Buildah’s commands replicate all of the commands that are found in a Dockerfile. This allows building images with and without Dockerfiles while not requiring any root privileges. The flexibility of building images without Dockerfiles also allows for the integration of other scripting languages into the build process.</p>
</div>
<div class="paragraph">
<p><mark>Podman</mark> specializes in all of the commands and functions that help you to maintain and modify OCI images, such as pulling and tagging. It also allows you to create, run, and maintain those containers created from those images.</p>
</div>
<div class="paragraph">
<p><mark>Skopeo</mark> specializes in inspecting images and copying images from one location to another, converting formats if necessary.</p>
</div>
<div class="paragraph">
<p>These utilities are pre-installed on the workshop systems, but if you needed to install them on your own hosts, you would enter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo yum install -y buildah podman skopeo</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_2_create_a_container_for_development_using_buildah">Section 2: Create a container for development using buildah</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, we will use buildah to pull down the Red Hat ubi image to use as our base container image, which we will build on to create our application image.</p>
</div>
<div class="sect2">
<h3 id="_step_1_use_buildah_to_pull_the_base_image">Step 1: Use buildah to pull the base image</h3>
<div class="paragraph">
<p>The Red Hat Universal base image (UBI) is a convenient starting point for creating containers. It offers official RHEL bits for building container images, but offers more freedom in how they are used and distributed. There are three versions of it, standard, minimal and runtimes. For this workshop we will use the standard image.</p>
</div>
<div class="paragraph">
<p>To build an application container from the base image, we will create a working container with <mark>buildah</mark>. A working container is a temporary container used as the target for buildah commands.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">buildah from registry.access.redhat.com/ubi8/ubi:latest</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_verify_the_container_image_pulled_correctly">Step 2: Verify the container image pulled correctly</h3>
<div class="paragraph">
<p>Verify that your pull request for the container image completed. Using the buildah command will display and allow you to verify what container images your user has access to.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Buildah will append <mark>-working-container</mark> to the image name used. If that name already exists, a number will also be appended.  For this exercise, you should see an image with the container name <mark>ubi-working-container</mark>.
</td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">buildah containers</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>CONTAINER ID  BUILDER  IMAGE ID            IMAGE NAME           CONTAINER NAME
xxxxxxxxxxx   *        xxxxxxx             registry…/:latest    ubi-working-container</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_3_creating_an_application_image_from_an_existing_base">Section 3: Creating an application image from an existing base</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_step_1_install_apache_httpd_on_the_ubi_base_container_image">Step 1: Install apache (httpd) on the UBI base container image</h3>
<div class="paragraph">
<p>The <mark>UBI</mark> standard variant is very complete, including tools like <mark>yum</mark> and <mark>systemd</mark>. You can install <mark>httpd</mark> via <mark>yum</mark> in the container using the <mark>buildah run</mark> subcommand:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">buildah run ubi-working-container -- yum -y install httpd</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Updating Subscription Management repositories.
Unable to read consumer identity
This system is not registered to Red Hat Subscription Management. You can use subscription-manager to register.
Red Hat Universal Base Image 8 (RPMs) - BaseOS                                               1.3 MB/s | 767 kB     00:00
Red Hat Universal Base Image 8 (RPMs) - AppStream                                            6.4 MB/s | 3.9 MB     00:00
Red Hat Universal Base Image 8 (RPMs) - CodeReady Builder                                     79 kB/s |  11 kB     00:00
Dependencies resolved.
=============================================================================================================================
 Package                     Architecture    Version                                          Repository                Size
=============================================================================================================================
Installing:
 httpd                       x86_64          2.4.37-21.module+el8.2.0+5008+cca404a3           ubi-8-appstream          1.4 M


&lt;&lt; OUTPUT ABRIDGED &gt;&gt;
Complete!</pre>
</div>
</div>
<div class="paragraph">
<p>This subcommand acts like the RUN directive in an OCIFile (also known as a ContainerFile or DockerFile). Since the yum command includes a switch, we need to use the <mark>--</mark> syntax to tell <mark>buildah run</mark> there are no buildah options to look for past this point.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_install_a_simple_home_page">Step 2: Install a simple home page</h3>
<div class="paragraph">
<p>Once the packages are installed in the working container, place a one-line home page we can use to check that our container works properly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">echo &#39;Welcome to the RHEL8 workshop!&#39; &gt; index.html
buildah copy ubi-working-container index.html /var/www/html/index.html</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_set_httpd_to_start_at_launch">Step 3: Set httpd to start at launch</h3>
<div class="paragraph">
<p>Instead of using init scripts, the webserver will be started directly when the container is started. In order to keep the container running while the webserver is up, the foreground flag is added or the container would end as soon as it goes into the background.  To set httpd to start when the container is run, modify the metadata with the <mark>buildah config</mark> subcommand.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">buildah config --cmd &#34;/usr/sbin/httpd -D FOREGROUND&#34; ubi-working-container</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above option to <mark>buildah config</mark> is equivalent to the CMD directive in an OCIFile (ContainerFile, DockerFile)</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_expose_the_http_port_on_the_container">Step 4: Expose the http port on the container</h3>
<div class="paragraph">
<p>To get access to the web server, http port 80 needs to be opened</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">buildah config --port 80 ubi-working-container</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_commit_changes_to_the_modified_base_container_using_buildah">Step 5: Commit changes to the modified base container using buildah</h3>
<div class="paragraph">
<p>Once the contents of the working container are complete, and the metadata has been updated, save the working container as the target application image using <mark>buildah commit</mark>. During the container customization process, you can choose how often you want to save your customizations in order to test each modification that has been completed. In this case we are saving both the installation of apache, a simple home page and the directive to start the httpd service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">buildah commit ubi-working-container httpd</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Getting image source signatures
Skipping fetch of repeat blob sha256:24d85c895b6b870f6b84327a5e31aa567a5d30588de0a0bdd9a669ec5012339c
Skipping fetch of repeat blob sha256:c613b100be1645941fded703dd6037e5aba7c9388fd1fcb37c2f9f73bc438126
Skipping fetch of repeat blob sha256:188ab351dfda8afc656a38073df0004cdc5196fd5572960ff5499c17e6442223
Copying blob sha256:8df24355b15ad293a5dd60d0fe2c14dca68b0412b62f9e9c39c15bb8230d1936
26.80 MiB / 26.80 MiB [====================================================] 0s
Copying config sha256:b04fe2c73b034e657da2fee64c340c56086a38265777556fa8a02c5f12896e66
2.42 KiB / 2.42 KiB [======================================================] 0s
Writing manifest to image destination
Storing signatures
B04fe2c73b034e657da2fee64c340c56086a38265777556fa8a02c5f12896e66</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, each previous buildah subcommand results in a separate layer, much like building using an OCIFile. Note that we have named our save point as <strong>httpd</strong>. You can change this to any label that will reflect what changes you have made at that given save point.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_4_using_podman_to_launch_and_inspect_the_application_container">Section 4: Using podman to launch and inspect the application container</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_step_1_use_podman_to_inspect_available_images">Step 1: Use podman to inspect available images</h3>
<div class="paragraph">
<p>In the previous steps we used buildah to pull down a new image and customize that image. The last step of Section 3 had us commit the changes to the container and name it <mark>httpd</mark>. Using the podman command, we can view what containers are available to start and run.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman images</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>REPOSITORY           TAG      IMAGE ID       CREATED          SIZE
localhost/httpd      latest   b04fe2c73b03   24 sec ago       242 MB
regi.../ubi          latest   8c376a94293d   2 weeks ago      211 MB</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The name matches what was set using <mark>buildah commit</mark>.
</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_use_podman_to_start_the_customized_container_and_bind_port_8080">Step 2: Use podman to start the customized container and bind port 8080</h3>
<div class="paragraph">
<p>Podman and buildah use the same local image storage locations, which lets us immediately run our new image without specifying the location of the container or system on which the container will run. Note we are using the name httpd that we created in our previous section. As mentioned previously, you can launch, test, and then stop the container as you make each individual change. This can be used for general application testing or debugging of a change made to the container during customization with buildah.</p>
</div>
<div class="paragraph">
<p>the container’s port 80 is at this point bound to port 8080 so it could be started by a non-root user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman run -d -p 8080:80 httpd</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>f4d9db69e9b512517f9490d3bcc5096e69cca5e9b3a50b3890430da39ae46573</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_inspect_container_and_verify_the_application_in_the_container_is_running_and_accessible">Step 3: Inspect container and verify the application in the container is running and accessible</h3>
<div class="paragraph">
<p>Now, we can check the status of the application container using podman.  Note you can also see the forwarded ports:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman ps</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>CONTAINER ID  IMAGE                        COMMAND              CREATED         STATUS            PORTS                   NAMES
f4d9db69e9b5  localhost/httpd:latest   /usr/bin/run-http... 16 seconds ago  Up 16 seconds ago  0.0.0.0:8080-&gt;80/tcp  amazing_tharp</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You may ask yourself what this &#34;amazing_tharp&#34; business is about in the output above. Podman generates random two word names for new containers, which you can use to refer to specific container.  What two word name was generated for your container?
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Further, you can view the container’s processes with the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman top -l</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>USER      PID   PPID   %CPU    ELAPSED           TTY   TIME   COMMAND
default   1     0      0.000   6m24.454912357s   ?     0s     /usr/sbin/httpd -DFOREGROUND
default   6     1      0.000   6m24.455036731s   ?     0s     /usr/sbin/httpd -DFOREGROUND
default   7     1      0.000   6m24.455132107s   ?     0s     /usr/sbin/httpd -DFOREGROUND
default   9     1      0.000   6m24.455458435s   ?     0s     /usr/sbin/httpd -DFOREGROUND
default   14    1      0.000   6m24.455616596s   ?     0s     /usr/sbin/httpd -DFOREGROUND</pre>
</div>
</div>
<div class="paragraph">
<p>Now, we can test retrieval of our example home page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">curl -s http://localhost:8080</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Welcome to the RHEL8 workshop!</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Note the URL specified matches the port mapping specified on the <mark>podman run</mark> command.
</td>
</tr>
</tbody></table>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you get an error message such as &#34;You don’t have permission to access this resource.&#34;, you may need to inspect the permissions of the index.html file you copied into the container image.
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_step_4_stop_the_container">Step 4: Stop the container</h4>
<div class="paragraph">
<p>Since your test was successful, you can now stop the container, and continue with additional customization that you would like to try out. Remember to commit your changes as often as you would like, during the customization process, and use names that reflect the customization you have done to ease troubleshooting.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman stop -a</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will stop all containers that you have running via podman.</p>
</div>
<div class="paragraph">
<p>You can verify that the container has stopped running by looking at the list of container processes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman ps -l</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first line of the output should show a container that was recently stopped, similar to the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CONTAINER ID  IMAGE                       COMMAND               CREATED        STATUS                     PORTS                 NAMES
11fcab28fd31  localhost/httpd:latest  /bin/sh -c /usr/s...  4 minutes ago  Exited (0) 10 seconds ago  0.0.0.0:8080-&gt;80/tcp  amazing_tharp</pre>
</div>
</div>
<div class="paragraph">
<p>Notice the STATUS field is now reported as Exited.</p>
</div>
<div class="paragraph">
<p>Alternatively, if you would prefer to stop only a single container, you can utilize <mark>podman ps</mark> to identify the Container ID you wish to stop.  (If you’ve already performed the <mark>stop -a</mark>, you can re-start the container with the <mark>podman run</mark> command shown in Step 2, above.)  Then use the following command, with your unique Container ID number, to shutdown a single instance. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman stop 11fcab28fd31</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_6_use_skopeo_and_podman_to_integrate_the_container_into_systemd">Section 6: Use skopeo and podman to integrate the container into systemd</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Running as ec2-user, the container work that you have done is stored in your home directory. We will move it to the system image store in /var/lib/, enable it and start the application.</p>
</div>
<div class="sect2">
<h3 id="_step_0_disable_fapolicyd">Step 0: Disable Fapolicyd</h3>
<div class="paragraph">
<p>Before we get started, we need to disable Fapolicyd (the File Access Policy Daemon) for this exercise. You enabled this during the mitigation steps in Exercise 1.7. Fapolicyd will prevent the container based application from starting.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo systemctl disable --now fapolicyd.service</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Removed /etc/systemd/system/multi-user.target.wants/fapolicyd.service.</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_1_inspecting_the_httpd_image">Step 1: Inspecting the httpd image</h3>
<div class="paragraph">
<p>First let’s use skopeo to inspect the image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">skopeo inspect containers-storage:localhost/httpd</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>{
    &#34;Name&#34;: &#34;localhost/httpd&#34;,
    &#34;Digest&#34;: &#34;sha256:0dbc14b4aa06a3232087d5fa329b158dfe580686fa00e9383f78ee64e3d3ae0f&#34;,
    &#34;RepoTags&#34;: [],
    &#34;Created&#34;: &#34;2020-07-29T03:26:45.369889926Z&#34;,
    &#34;DockerVersion&#34;: &#34;&#34;,
    &#34;Labels&#34;: {

&lt;&lt;output truncate&gt;&gt;

}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_transfer_the_image_into_the_operating_system_image_store">Step 2: Transfer the image into the operating system image store</h3>
<div class="paragraph">
<p>First export the image from ec2-user’s image store into an archive file. Skopeo can export containers into either docker archive or OCI archive if we want to put the container into a file. Using the OCI archive format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">skopeo copy containers-storage:localhost/httpd oci-archive:httpd.tar</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Getting image source signatures
Copying blob 226bfaae015f done
Copying blob 70056249a0e2 done
Copying blob 1ff90c7e6397 done
Copying config 80dd2eb93b done
Writing manifest to image destination
Storing signatures</pre>
</div>
</div>
<div class="paragraph">
<p>Import the archive into the system image store</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo skopeo copy oci-archive:httpd.tar containers-storage:localhost/httpd</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>WARN[0000] Not using native diff for overlay, this may cause degraded performance for building images: kernel has CONFIG_OVERLAY_FS_REDIRECT_DIR enabled
Getting image source signatures
Copying blob b80ee16c8662 done
Copying blob 6eeb9b4a640f done
Copying blob ae48556e82ac done
Copying config 80dd2eb93b done
Writing manifest to image destination
Storing signatures</pre>
</div>
</div>
<div class="paragraph">
<p>The container should now be visible in the system image store</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo podman images</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>REPOSITORY        TAG      IMAGE ID       CREATED          SIZE
localhost/httpd   latest   80dd2eb93b53   37 minutes ago   242 MB</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_scan_the_container_image_for_cves">Step 3: Scan the container image for CVEs</h3>
<div class="paragraph">
<p>Before using this container image in a system service, let’s check it for CVEs.  Since RHEL 8.2, the <mark>oscap-podman</mark> utility has been included for scanning container images.  Let’s see how this works!</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<mark>oscap-podman</mark> requires root privilege.
</td>
</tr>
</tbody></table>
</div>
<div class="sect3">
<h4 id="_step_3a_download_the_latest_red_hat_security_advisories">Step 3a: Download the latest Red Hat Security Advisories</h4>
<div class="paragraph">
<p>Red Hat continuously updates security data feeds on <mark><a href="https://access.redhat.com/security/data" class="bare">https://access.redhat.com/security/data</a></mark>.  Let’s start by retrieving and decompressing the latest RHEL advisories in OVAL format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">curl https://www.redhat.com/security/data/oval/v2/RHEL8/rhel-8.oval.xml.bz2 | bzip2 --decompress &gt; rhel-8.oval.xml</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_step_3b_scan_a_container_image_with_oscap_podman">Step 3b: Scan a container image with oscap-podman</h4>
<div class="paragraph">
<p>Pick an <mark>IMAGE ID</mark> from the previous <mark>sudo podman images</mark> output — in this case, the httpd image — and run the scan with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo oscap-podman 80dd2eb93b53 oval eval --report /var/www/html/image-oval-report.html rhel-8.oval.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the command completes, open this link in another tab to view the resulting report:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">http://node-<span class="userid">0</span>.<span class="prefix">example</span>.<span class="domain">redhatgov.io</span>/image-oval-report.html</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_integrate_container_into_systemd">Step 4: Integrate container into systemd</h3>
<div class="paragraph">
<p>To finish this section, let’s integrate our new container into systemd so you can have it start at boot time and otherwise manage it using systemd. Before getting started, ensure that the webserver started in the openSCAP section is not running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo systemctl stop httpd</code></pre>
</div>
</div>
<div class="paragraph">
<p>First prepare the container by creating it using our new image and configuring it to expose port 80. This container will be named &#34;web&#34;.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo podman create -p 80:80 --name web httpd</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next generate the systemd configuration file. The default filename is container-&lt;name&gt;.service</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo podman generate systemd --name web -f</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create a systemd configuration file in the current working directory. Inspect the configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">cat container-web.service</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre># container-web.service
# autogenerated by Podman 1.9.3
# Wed Jul 29 04:45:39 UTC 2020

[Unit]
Description=Podman container-web.service
Documentation=man:podman-generate-systemd(1)
Wants=network.target
After=network-online.target

[Service]
Environment=PODMAN_SYSTEMD_UNIT=%n
Restart=on-failure
ExecStart=/usr/bin/podman start web
ExecStop=/usr/bin/podman stop -t 10 web
PIDFile=/var/run/containers/storage/overlay-containers/8ad6217bd93b39920b11161e1cd958e80cce42c1310ee716421fd4672f7f3953/userdata/conmon.pid
KillMode=none
Type=forking

[Install]
WantedBy=multi-user.target default.target</pre>
</div>
</div>
<div class="paragraph">
<p>Finally move this service file into systemd configation and start the service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo cp container-web.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable --now container-web.service</code></pre>
</div>
</div>
<div class="paragraph">
<p>Confirm that the container is started and it’s port 80 is connected to the host’s port 80.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">sudo podman ps</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>CONTAINER ID  IMAGE                   COMMAND               CREATED        STATUS            PORTS               NAMES
8ad6217bd93b  localhost/httpd:latest  /usr/sbin/httpd -...  9 minutes ago  Up 5 seconds ago  0.0.0.0:80-&gt;80/tcp  web</pre>
</div>
</div>
<div class="paragraph">
<p>Verify that the webserver is running</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">curl -s http://localhost</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Welcome to the RHEL8 workshop!</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_section_6_some_other_interesting_podman_commands">Section 6: Some other interesting podman commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here are some lesser-known <mark>podman</mark> features that’re really worth knowing about.</p>
</div>
<div class="sect2">
<h3 id="_exporting_a_container_definition_for_use_in_openshift">Exporting a container definition for use in OpenShift</h3>
<div class="paragraph">
<p>If you’ve built and tested a container with podman, and are happy with the results, you can very easily share that container with OpenShift.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman generate kube $(podman ps --quiet -l) &gt; export.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Take a look at the file to see what’s in it.  If you were in an OpenShift project, you could then import this file with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">oc create -f export.yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is an example of a single container export, but you can export complete pods as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="_removing_a_container">Removing a container</h3>
<div class="paragraph">
<p>If a container will no longer be used, you can remove it from the system using <mark>podman rm</mark>. In the command below, we use a bit of bash scripting to return the CONTAINER ID of the last container that was running as it is unique to each container image.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">podman rm $(podman ps --quiet -l)</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>af2d3774f20b5afb4505a4eb3fea20df5861afd6ec06b9271b6419ff1515106d</pre>
</div>
</div>
<div class="paragraph">
<p>The output of this removal is the full CONTAINER ID which was removed from the system.</p>
</div>
<div class="paragraph">
<style>

 
.modal {
  display: none;  
  position: fixed;  
  z-index: 1;  
  left: 0;
  top: 0;
  width: 100%;  
  height: 100%;  
  overflow: auto;  
  background-color: rgb(0,0,0);  
  background-color: rgba(0,0,0,0.4);  
  -webkit-animation-name: fadeIn;  
  -webkit-animation-duration: 0.4s;
  animation-name: fadeIn;
  animation-duration: 0.4s
}

 
.modal-content {
  position: fixed;
  bottom: 0;
  background-color: #fefefe;
  width: 100%;
  -webkit-animation-name: slideIn;
  -webkit-animation-duration: 0.4s;
  animation-name: slideIn;
  animation-duration: 0.4s
}

 
.close {
  color: white;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}

.modal-header {
  padding: 2px 16px;
  background-color: #000000;
  color: white;
}

.modal-body {padding: 2px 16px;}

.modal-footer {
  padding: 2px 16px;
  background-color: #000000;
  color: white;
}

 
@-webkit-keyframes slideIn {
  from {bottom: -300px; opacity: 0}
  to {bottom: 0; opacity: 1}
}

@keyframes slideIn {
  from {bottom: -300px; opacity: 0}
  to {bottom: 0; opacity: 1}
}

@-webkit-keyframes fadeIn {
  from {opacity: 0}
  to {opacity: 1}
}

@keyframes fadeIn {
  from {opacity: 0}
  to {opacity: 1}
}
</style>

<div id="myModal" class="modal">

  
  <div class="modal-content">
    <div class="modal-header">
      <span class="close">&times;</span>
      <h3>Workshop Details</h3>
    </div>
    <div class="modal-body">
<div class="row">
  <div class="col-lg-4 col-md-5 col-sm-12" id="workshopFooterDetails">
    <table>
      <tr>
        <td class="text-right"><b>Domain</b></td>
        <td><span class="domain"></span></td>
        <td rowspan="3">
        <img src="/images/Logo-Red_Hat-C-Standard-RGB-small.png" alt="Red Hat Logo" />
        </td>
      </tr>
      <tr>
        <td class="text-right"><b>Workshop</b></td>
        <td><span class="prefix"></span></td>
      </tr>
      <tr>
        <td class="text-right"><b>Student ID</b></td>
        <td><span class="userid"></span></td>
      </tr>
    </table>
  </div>
  <div class="col-lg-8 col-md-7 col-sm-12">
    <form id="footerForm" onsubmit="return false;" class="row" style="padding: 1.75rem 0 0 0;">
      <div class="form-group col-sm-6 col-md-6 col-lg-2">
        <label for="userid">Student ID</label>
        <select id="userid" name="userid">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10</option>
          <option value="11">11</option>
          <option value="12">12</option>
          <option value="13">13</option>
          <option value="14">14</option>
          <option value="15">15</option>
          <option value="16">16</option>
          <option value="17">17</option>
          <option value="18">18</option>
          <option value="19">19</option>
          <option value="20">20</option>
          <option value="21">21</option>
          <option value="22">22</option>
          <option value="23">23</option>
          <option value="24">24</option>
          <option value="25">25</option>
          <option value="26">26</option>
          <option value="27">27</option>
          <option value="28">28</option>
          <option value="29">29</option>
          <option value="30">30</option>
          <option value="31">31</option>
          <option value="32">32</option>
          <option value="33">33</option>
          <option value="34">34</option>
          <option value="35">35</option>
          <option value="36">36</option>
          <option value="37">37</option>
          <option value="38">38</option>
          <option value="39">39</option>
          <option value="40">40</option>
          <option value="41">41</option>
          <option value="42">42</option>
          <option value="43">43</option>
          <option value="44">44</option>
          <option value="45">45</option>
          <option value="46">46</option>
          <option value="47">47</option>
          <option value="48">48</option>
          <option value="49">49</option>
          <option value="50">50</option>
          <option value="51">51</option>
          <option value="52">52</option>
          <option value="53">53</option>
          <option value="54">54</option>
          <option value="55">55</option>
          <option value="56">56</option>
          <option value="57">57</option>
          <option value="58">58</option>
          <option value="59">59</option>
          <option value="60">60</option>
          <option value="61">61</option>
          <option value="62">62</option>
          <option value="63">63</option>
          <option value="64">64</option>
          <option value="65">65</option>
          <option value="66">66</option>
          <option value="67">67</option>
          <option value="68">68</option>
          <option value="69">69</option>
          <option value="70">70</option>
          <option value="71">71</option>
          <option value="72">72</option>
          <option value="73">73</option>
          <option value="74">74</option>
          <option value="75">75</option>
          <option value="76">76</option>
          <option value="77">77</option>
          <option value="78">78</option>
          <option value="79">79</option>
          <option value="80">80</option>
          <option value="81">81</option>
          <option value="82">82</option>
          <option value="83">83</option>
          <option value="84">84</option>
          <option value="85">85</option>
          <option value="86">86</option>
          <option value="87">87</option>
          <option value="88">88</option>
          <option value="89">89</option>
          <option value="90">90</option>
          <option value="91">91</option>
          <option value="92">92</option>
          <option value="93">93</option>
          <option value="94">94</option>
          <option value="95">95</option>
          <option value="96">96</option>
          <option value="97">97</option>
          <option value="98">98</option>
          <option value="99">99</option>
          <option value="100">100</option>
          <option value="101">101</option>
          <option value="102">102</option>
          <option value="103">103</option>
          <option value="104">104</option>
          <option value="105">105</option>
          <option value="106">106</option>
          <option value="107">107</option>
          <option value="108">108</option>
          <option value="109">109</option>
          <option value="110">110</option>
          <option value="111">111</option>
          <option value="112">112</option>
          <option value="113">113</option>
          <option value="114">114</option>
          <option value="115">115</option>
          <option value="116">116</option>
          <option value="117">117</option>
          <option value="118">118</option>
          <option value="119">119</option>
          <option value="120">120</option>
          <option value="121">121</option>
          <option value="122">122</option>
          <option value="123">123</option>
          <option value="124">124</option>
          <option value="125">125</option>
          <option value="126">126</option>
          <option value="127">127</option>
          <option value="128">128</option>
          <option value="129">129</option>
          <option value="130">130</option>
          <option value="131">131</option>
          <option value="132">132</option>
          <option value="133">133</option>
          <option value="134">134</option>
          <option value="135">135</option>
          <option value="136">136</option>
          <option value="137">137</option>
          <option value="138">138</option>
          <option value="139">139</option>
          <option value="140">140</option>
          <option value="141">141</option>
          <option value="142">142</option>
          <option value="143">143</option>
          <option value="144">144</option>
          <option value="145">145</option>
          <option value="146">146</option>
          <option value="147">147</option>
          <option value="148">148</option>
          <option value="149">149</option>
          <option value="150">150</option>
          <option value="151">151</option>
          <option value="152">152</option>
          <option value="153">153</option>
          <option value="154">154</option>
          <option value="155">155</option>
          <option value="156">156</option>
          <option value="157">157</option>
          <option value="158">158</option>
          <option value="159">159</option>
          <option value="160">160</option>
          <option value="161">161</option>
          <option value="162">162</option>
          <option value="163">163</option>
          <option value="164">164</option>
          <option value="165">165</option>
          <option value="166">166</option>
          <option value="167">167</option>
          <option value="168">168</option>
          <option value="169">169</option>
          <option value="170">170</option>
          <option value="171">171</option>
          <option value="172">172</option>
          <option value="173">173</option>
          <option value="174">174</option>
          <option value="175">175</option>
          <option value="176">176</option>
          <option value="177">177</option>
          <option value="178">178</option>
          <option value="179">179</option>
          <option value="180">180</option>
          <option value="181">181</option>
          <option value="182">182</option>
          <option value="183">183</option>
          <option value="184">184</option>
          <option value="185">185</option>
          <option value="186">186</option>
          <option value="187">187</option>
          <option value="188">188</option>
          <option value="189">189</option>
          <option value="190">190</option>
          <option value="191">191</option>
          <option value="192">192</option>
          <option value="193">193</option>
          <option value="194">194</option>
          <option value="195">195</option>
          <option value="196">196</option>
          <option value="197">197</option>
          <option value="198">198</option>
          <option value="199">199</option>
          <option value="200">200</option>
        </select>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-4">
        <label for="domain">Domain</label>
        <select id="domain" name="domain">
          <option value="rhnaps.io">rhnaps.io</option>
          <option value="redhatgov.io">redhatgov.io</option>
          <option value="az.redhatgov.io">az.redhatgov.io</option>
          <option value="redhat-fierce.io">redhat-fierce.io</option>
          <option value="fiercesw.network">fiercesw.network</option>
          <option value="rhtps.io">rhtps.io</option>
          <option value="openshiftworkshop.com">openshiftworkshop.com</option>
          <option value="redhatpsmwsa.com">redhatpsmwsa.com</option>
          <option value="open.redhat.com">open.redhat.com</option>
          <option value="opentlc.com">opentlc.com</option>
          <option value="aroapp.io">aroapp.io</option>
          <option value="danclark.io">danclark.io</option>
        </select>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-3">
        <label for="prefix">Workshop</label>
        <input id="prefix" name="prefix" type="text" size="16" class="form-control" placeholder="example" onkeyup="this.value = this.value.toLowerCase();this.value = this.value.replace(/[^-.a-zA-Z0-9]/g, '');"/>
      </div>
      <div class="form-group col-sm-6 col-md-6 col-lg-3">
        <button type="submit" class="btn btn-primary form-control" style="margin-bottom:1rem;">Enter</button>
        <button type="reset" class="btn btn-default form-control">Default</button>
      </div>
    </form>
  </div>
</div>

    </div>
    <div class="modal-footer">
      <h3></h3>
    </div>
  </div>

</div>

<script type="text/javascript" src="/node_modules/js-cookie/src/js.cookie.js"></script>
<script type="text/javascript">

  
  var Cookies2 = Cookies.noConflict();

  var cookiePathArr = cleanArray(window.location.pathname.split('/'));
  var cookiePath = '/' + cookiePathArr[0] + '/' + cookiePathArr[1] + '/';

  function cleanArray(actual) {
    var newArray = new Array();
    for (var i = 0; i < actual.length; i++) {
      if (actual[i]) {
        newArray.push(actual[i]);
      }
    }
    return newArray;
  }
  function replaceClassText() {
    jQuery("span.domain").html(Cookies2.get("domain"));
    jQuery("span.userid").html(Cookies2.get("userid"));
    jQuery("span.prefix").html(Cookies2.get("prefix"));
  }
  function pageLoadWorkshopFooterTest() {
    
    if (Cookies2.get("domain") === undefined) {
      resetWorkshopFooter();
    }
    else {
      replaceClassText();
      setWorkshopFooterInputValues()
    }
  }
  function setWorkshopFooterData() {
    
    Cookies2.set("domain", jQuery("select#domain").val(), { path: cookiePath, expires: 7 } );
    Cookies2.set("prefix", jQuery("input#prefix").val().replace(/[^-.a-zA-Z0-9]/g, ''), { path: cookiePath, expires: 7 } );
    Cookies2.set("userid", jQuery("select#userid").val(), { path: cookiePath, expires: 7 } );
    replaceClassText();
    modal.style.display = "none";
  }
  function setWorkshopFooterInputValues() {
    jQuery("select#domain").val(Cookies2.get("domain"));
    jQuery("input#prefix").val(Cookies2.get("prefix"));
    jQuery("select#userid").val(Cookies2.get("userid"));
  }
  function resetWorkshopFooter() {
    
    jQuery("select#domain, select#userid").prop("selectedIndex", 0);
    jQuery("input#prefix").val(jQuery("input#prefix").attr('placeholder'));
    
    Cookies2.set("domain", jQuery("select#domain option").first().val(), { path: cookiePath, expires: 7 } ); 
    Cookies2.set("userid", jQuery("select#userid option").first().val(), { path: cookiePath, expires: 7 } ); 
    Cookies2.set("prefix", jQuery("input#prefix").val(), { path: cookiePath, expires: 7 } );
    
    
    replaceClassText();
  }




  function updateFooter(e){
    fieldName = '';

    switch(e.id) {
      case 'userid':
        fieldName = 'User Id';
        break;
      case 'domain':
        fieldName = 'Domain';
        break;
      case 'prefix':
        fieldName = 'Workshop';
        break;
      default:
        fieldName = 'unknown';
    }
    setWorkshopFooterData();
    toastr["success"](fieldName + " set to " + e.value);
  }

  jQuery(document).ready(function() {
    pageLoadWorkshopFooterTest();


    
    var input = document.getElementById("prefix");

    
    input.addEventListener("keyup", function(event) {
      
      if (event.keyCode === 13) {
        
        event.preventDefault();
        
        
        updateFooter(input);
      }
    });


    jQuery("form#footerForm").submit(function() {
      setWorkshopFooterData();
      return false; 
    });

    jQuery("form#footerForm").bind("reset", function() {
      resetWorkshopFooter();
      return true;
    });

    return false;
  });

</script>

<hr>
<h3>Workshop Details</h3>
    <table>
      <tr>
        <td class="text-right"><b>Domain</b></td>
        <td><span class="domain"></span></td>
        <td rowspan="3">
          <img src="/images/Logo-Red_Hat-C-Standard-RGB-small.png" alt="Red Hat Logo" />
        </td>
      </tr>
      <tr>
        <td class="text-right"><b>Workshop</b></td>
        <td><span class="prefix"></span></td>
      </tr>
      <tr>
        <td class="text-right"><b>Student ID</b></td>
        <td><span class="userid"></span></td>
      </tr>
    </table>
<button id="myBtn">Configure Workshop</button>
<hr>

<script>

var modal = document.getElementById("myModal");


var btn = document.getElementById("myBtn");


var span = document.getElementsByClassName("close")[0];


btn.onclick = function() {
  modal.style.display = "block";
}


span.onclick = function() {
  modal.style.display = "none";
}


window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>


</div>
</div>
</div>
</div>


    








<nav>
  <ul class="pager">
    
    
    <li class="previous">
      <a href="/workshops/rhel_8/exercise1.7/">&larr; Previous: Exercise 1.7 - OpenSCAP Security Compliance Scanning</a>
    </li>
    
    
    
    
    <li class="next">
      <a href="/workshops/rhel_8/exercise1.9/">Next: Exercise 1.9 - System Roles with Ansible &rarr;</a>
    </li>
    
    
  </ul>
</nav>

    <p class="text-center">
      
      <a href="/workshops/rhel_8">Return to Workshop</a>
    </p>
  </div>
</div>

    <div id="page-footer" class="container">
      <p class="text-center">
        Copyright &copy; 2024 Red Hat, Inc.
      </p>
    </div>
    <script type="text/javascript">
      if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
          _satellite.pageBottom();
      }
    </script>
  </body>
</html>
